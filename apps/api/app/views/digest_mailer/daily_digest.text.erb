Your gift updates!

<%= @total_changes %> update<%= 's' if @total_changes != 1 %> from your shared holidays

<% @changes_by_holiday.each do |holiday, changes| %>
<%= holiday.icon.presence || 'ðŸŽ' %> <%= holiday.name %>
<%= '=' * (holiday.name.length + 4) %>

<% changes.each do |change| %>
<% gift_name = change.gift&.name || change.changes_data.dig('name', 1) || change.changes_data['name'] || 'Gift' %>
â€¢ <%= gift_name %> [<%= change.created? ? 'NEW' : 'UPDATED' %>]
  Added by <%= change.user&.first_name.presence || change.user.email.split('@').first %>
<% if change.updated? && change.changes_data.present? %>
<% change.changes_data.each do |field, values| %>
<% next if field == 'updated_at' %>
<% if values.is_a?(Array) %>
  <%= field.humanize %>: <%= values[0].presence || 'empty' %> â†’ <%= values[1] %>
<% end %>
<% end %>
<% end %>

<% end %>
<% end %>

View your holidays: <%= @frontend_url %>/holidays
